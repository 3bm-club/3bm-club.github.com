<html>
<head>
<title>Reverse leason1</title>
<link rel="stylesheet" type="text/css" href="../style.css">
<meta charset="cp-1251">
</head>
<body>
<iframe src="../menu.html" width="100%" height="230" align="center"  scrolling="no" frameborder="0" framespacing="0">
</iframe>
И мы снова отправляемся в волшебную страну Реверсляндию. Сегодня мы ревёрснем очередного злого exeкона. Из рыцарского снаряжения нам понадобиться IDA PRO и HxD(hex-редактор). Кстати этот exeкон тоже водиться в замке CSAW. Ну так вот, давайте сначала на него посмотрим. Это очень хитрый и коварный exeкон, он отдаёт нам флаг сразу, ну и по виду этого флага, мы можем догадаться, что это не совсем то за чем мы сюда пришли. Давайте пользовать IDA PRO. Дизасемблировали файл, и встаёт вопрос: что делать дальше. Единственное, что мы знаем наверняка - это то, что заголовок окна с флагом: Flag. Нажимаем Shift+F12 чтобы увидеть все строки используемые в программе, и о чудо, там есть строка Flag. Дважды кликаем по этой строке, и попадаем в то место программы, где эта строка лежит, видим что она называется Caption. Ставим курсор на Caption и жмём на кнопочку X. Теперь мы видим все места в коде, где используется эта переменная, таких мест два. Ну и, видимо, это наше окно, которое мы уже видели и окно с верным флагом. Давайте взглянем как там это устроено. Мы видим условие, после которого идут две ветки, одна выводит фальшивый флаг, вторая вычисляет и выводит нужный. Нам осталось только развернуть условие. В левом нижнем углу IDA смотрим адрес команды. Теперь, когда мы нашли слабое место exeкона, нам нужно его туда бить. Открываем HxD и находим нужный адрес. По этому адресу записано 75 - код команды jnz, и меняем его на 74 - код jz(обратная команда). Всё. Теперь при запуски программы мы будем получать нужный флаг. Победа))
<br>
<img src="https://pp.vk.me/c417422/v417422945/4c5a/E1Fql40q5RA.jpg"></img>
<img src="https://pp.vk.me/c417422/v417422945/4c64/f79Y3OrTGOI.jpg"></img>
<img src="https://pp.vk.me/c417422/v417422945/4c6e/Ky3gxlW65bY.jpg"></img>
</body>
</html>