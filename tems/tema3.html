<html>
<head>
<title>Reverse leason1</title>
<link rel="stylesheet" type="text/css" href="../style.css">
<meta charset="cp-1251">
</head>
<body>
<iframe src="../menu.html" width="100%" height="230" align="center"  scrolling="no" frameborder="0" framespacing="0">
</iframe>
Итак, сегодняшний наш враг стоит аж 200 золотых. И это снова он - exeкон, вообще это просто какое-то чудо, мы снова можем пользоваться только Windows, не смотря квадратными глазами в линуксы. Посмотри что вообще делает наша програмулина. Падает. Тоже не плохо, но хотелось бы немного больше экшена. Давайте откроем IDA Pro и попытаемся найти в чём же причина такого не замысловатого поведения. После дизасемблирования встаёт вопрос, что с этим всем делать. Золотое правило:" не знаешь что делать - смотри строки". Нажимаем Shift+F12. У нас выпал список всех строк в программе, первые строки во всех PE одинаковые, смотрим в конце. Видим, что у нас есть строчка "Flag", а в остальных строчках шлак лежит. Смело выделяем найденную строку, и нажимаем Enter. Мы видим что это переменная Caption, и судя по названию - это заголовок диалогового окна. Что находиться внутри окна, я думаю, уже все догадались. Нажимаем "X", у нас вылетело окно с местами в программе где используется Caption. Такое место одно. Кликаем по названию места и телепортируемся туда. Там у нас условие, первая ветка вычисляет флаг и выводит на экран, вторая сразу хочет вывести флаг, но так как он ещё не создан, то программа взрывается. Нам осталось только развернуть условие. Смотрим адрес команды с условием, окрываем HxD и меняем команду по этому адресу на противоположную. 74 на 75. Запускаем. Опа. Эта как-то мало смахивает на флаг, вероятно где-то после генерации флаг уродуется. У нас возникает тяжёлый моральна-этический выбор: плача кровавыми слезами анализировать ассемблерный листинг и искать где у нас портиться флаг, или запустить в дебагере и попробовать поймать промежуточную стадию флага. Лично я предпочёл второй способ. У меня это Olly Dbg, я запускаю в нём программу, и начинаю пошагово выполнять(F7), при этом что происходит в коде нам не важно, мы следим за тем что у нас кладётся в память и регистры(окошко справа). И о чудо, в регистр EDX кладётся строка с флагом. Ну всё, флаг найден, враг повержен)))
<br>
<a href="#"><img src="https://pp.vk.me/c417422/v417422945/4c32/v4qMQS0lLxc.jpg"></img></a>
<a href="#"><img src="https://pp.vk.me/c417422/v417422945/4c3c/GhyWFGIeAyk.jpg"></img></a>
<a href="#"><img src="https://pp.vk.me/c417422/v417422945/4c46/qNhO1hVdDrw.jpg"></img></a>
<a href="#"><img src="https://pp.vk.me/c417422/v417422945/4c50/uu01diu5yHU.jpg"></img></a>
</body>
</html>